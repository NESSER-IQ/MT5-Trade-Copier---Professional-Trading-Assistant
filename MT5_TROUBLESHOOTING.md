# حل مشاكل الاتصال بـ MT5
# MT5 Connection Troubleshooting Guide

## ❌ الخطأ: `Terminal: Authorization failed (-6)`

### السبب
هذا الخطأ يعني أن تطبيق MT5 Terminal إما:
1. غير مفتوح
2. بيانات الاعتماد خاطئة
3. الحساب محظور أو منتهي

---

## ✅ الحلول

### 1️⃣ الحل الأول: افتح MT5 Terminal أولاً

**الخطوات:**
```
1. افتح MT5 Terminal (MetaTrader 5)
2. سجل دخول يدوياً بحسابك
3. تأكد من نجاح تسجيل الدخول
4. اترك MT5 Terminal مفتوحاً
5. الآن شغل البرنامج (run.bat)
6. اتصل من تبويب "الإعدادات"
```

**لماذا هذا مهم؟**
- البرنامج يحتاج MT5 Terminal ليكون قيد التشغيل
- لا يمكن الاتصال بـ MT5 إذا كان التطبيق مغلق

---

### 2️⃣ الحل الثاني: تحقق من بيانات الاعتماد

**في تبويب "الإعدادات"، تأكد من:**

#### رقم الحساب (Login):
- ✅ أرقام فقط (مثال: `12345678`)
- ❌ لا تضع نص أو حروف
- ❌ لا تستخدم علامات اقتباس

#### كلمة المرور (Password):
- ✅ نفس كلمة المرور المستخدمة في MT5 Terminal
- ⚠️ **حساسة لحالة الأحرف** (A ≠ a)

#### اسم الخادم (Server):
- ✅ نسخ الاسم الكامل من MT5 Terminal
- مثال صحيح: `MetaQuotes-Demo`
- مثال صحيح: `IC Markets-Live`
- ❌ خطأ: `MetaQuotes` (ناقص)
- ❌ خطأ: `ICMarkets` (بدون شرطة)

**كيف تحصل على اسم الخادم الصحيح؟**
```
1. افتح MT5 Terminal
2. Tools → Options → Server
3. انسخ الاسم بالضبط كما هو
```

---

### 3️⃣ الحل الثالث: حساب Demo للتجربة

إذا كنت تريد تجربة البرنامج بدون مخاطرة:

**إنشاء حساب Demo:**
```
1. افتح MT5 Terminal
2. File → Open an Account
3. اختر "Demo Account"
4. املأ البيانات:
   - الاسم
   - البريد الإلكتروني
   - نوع الحساب
   - الرصيد (مثال: 10000)
5. احفظ:
   - Login (رقم الحساب)
   - Password
   - Server
6. استخدمها في البرنامج
```

**ميزات حساب Demo:**
- ✅ مجاني 100%
- ✅ رصيد وهمي للتجربة
- ✅ نفس وظائف الحساب الحقيقي
- ✅ آمن للتعلم

---

### 4️⃣ الحل الرابع: تعطيل MT5 مؤقتاً

إذا كنت تريد اختبار **Telegram فقط** بدون MT5:

**الطريقة:**
```
1. افتح البرنامج
2. اتصل بـ Telegram فقط
3. لا تضغط "الاتصال بـ MT5"
4. اذهب إلى تبويب "الإشارات"
5. ستظهر الإشارات لكن لن يتم تنفيذها
```

---

## 🔍 فحص الاتصال

### اختبار MT5 يدوياً

قبل استخدام البرنامج، تأكد من:

```python
# اختبار سريع في Python Console
import MetaTrader5 as mt5

# 1. تهيئة
if not mt5.initialize():
    print("❌ فشل:", mt5.last_error())
else:
    print("✅ نجح التهيئة")

# 2. تسجيل الدخول
login = 12345678  # رقم حسابك
password = "YourPassword"
server = "MetaQuotes-Demo"

if mt5.login(login, password, server):
    print("✅ نجح تسجيل الدخول")
    info = mt5.account_info()
    print(f"الرصيد: {info.balance}")
else:
    print("❌ فشل:", mt5.last_error())

mt5.shutdown()
```

---

## 📋 قائمة فحص سريعة

قبل محاولة الاتصال، تحقق من:

- [ ] MT5 Terminal مفتوح ويعمل
- [ ] تم تسجيل الدخول في MT5 Terminal بنجاح
- [ ] رقم الحساب صحيح (أرقام فقط)
- [ ] كلمة المرور صحيحة (نفس MT5 Terminal)
- [ ] اسم الخادم صحيح (منسوخ من MT5)
- [ ] الحساب غير منتهي أو محظور
- [ ] لديك اتصال بالإنترنت

---

## 🐛 رسائل الأخطاء الشائعة

### `❌ فشل تهيئة MT5: (-6, 'Terminal: Authorization failed')`

**الأسباب:**
1. MT5 Terminal غير مفتوح ← **افتحه**
2. بيانات الاعتماد خاطئة ← **راجعها**
3. الحساب محظور ← **اتصل بالوسيط**

**الحل السريع:**
```
1. افتح MT5 Terminal
2. سجل دخول يدوياً
3. تأكد من نجاح الدخول
4. أعد المحاولة في البرنامج
```

---

### `❌ فشل تسجيل الدخول: (-6, 'Terminal: Authorization failed')`

**الأسباب:**
1. رقم الحساب خاطئ
2. كلمة المرور خاطئة
3. اسم الخادم خاطئ

**الحل السريع:**
```
1. في MT5 Terminal:
   Tools → Options → Server
2. انسخ:
   - Login
   - Server
3. كلمة المرور: نفسها في MT5
4. الصق في البرنامج **بالضبط**
```

---

### الرسالة تتكرر عدة مرات

**السبب:**
- البرنامج يحاول إعادة الاتصال تلقائياً

**الحل:**
```
1. لا تقلق - هذا طبيعي
2. أصلح السبب الأساسي (راجع أعلاه)
3. اضغط "الاتصال بـ MT5" مرة واحدة فقط
4. إذا فشل، لا تضغط عدة مرات
```

---

## 💡 نصائح مهمة

### 1. ابدأ بحساب Demo
```
✅ للتجربة والتعلم
✅ لا مخاطرة مالية
✅ نفس الوظائف
```

### 2. تحقق من البيانات دائماً
```
✅ انسخ والصق (لا تكتب يدوياً)
✅ تحقق من المسافات الزائدة
✅ تحقق من حالة الأحرف (A/a)
```

### 3. اترك MT5 Terminal مفتوحاً
```
✅ طوال فترة عمل البرنامج
✅ حتى لو صغرت النافذة
❌ لا تغلقه
```

### 4. استخدم الإعدادات المشفرة
```
✅ احفظ البيانات مرة واحدة
✅ لا حاجة لإعادة إدخالها
✅ آمنة ومشفرة
```

---

## 📞 الدعم

إذا استمرت المشكلة بعد تجربة جميع الحلول:

### معلومات مطلوبة للدعم:
```
1. نسخة MT5: (Tools → About)
2. نظام التشغيل: (Windows 10/11)
3. نوع الحساب: (Demo/Live)
4. اسم الوسيط
5. رسالة الخطأ الكاملة
6. هل MT5 Terminal مفتوح؟
7. هل تسجيل الدخول يدوياً يعمل؟
```

### الحصول على رسالة الخطأ:
```bash
# شغل البرنامج من Terminal لرؤية الأخطاء
python main_gui.py
```

---

## ✅ ملخص الخطوات الصحيحة

### الترتيب الصحيح للتشغيل:

```
1. افتح MT5 Terminal
   └─> سجل دخول يدوياً
       └─> تأكد من النجاح

2. افتح البرنامج (run.bat)
   └─> اذهب لتبويب "الإعدادات"
       └─> املأ بيانات MT5
           └─> "حفظ الإعدادات" (اختياري)
               └─> "الاتصال بـ MT5"
                   └─> انتظر رسالة "✅ تم الاتصال"

3. الآن يمكنك استخدام البرنامج
```

---

## 🎯 أمثلة ناجحة

### مثال 1: حساب Demo من MetaQuotes

```
Login: 5000123456
Password: Demo@123
Server: MetaQuotes-Demo

✅ النتيجة: اتصال ناجح
```

### مثال 2: حساب Live من IC Markets

```
Login: 1234567
Password: MyStr0ng!Pass
Server: ICMarkets-Live02

✅ النتيجة: اتصال ناجح
```

### مثال 3: خطأ شائع

```
Login: 1234567
Password: mypassword
Server: ICMarkets  ❌ خطأ (ناقص)

الصحيح:
Server: ICMarkets-Live02  ✅
```

---

**💪 مع هذه الخطوات، يجب أن يعمل MT5 بنجاح!**

**إذا استمرت المشكلة،  راجع [README_AR.md](README_AR.md) أو [QUICK_FIX.md](QUICK_FIX.md)**

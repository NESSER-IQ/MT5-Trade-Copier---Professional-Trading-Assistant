# ุชุญุฏูุซุงุช ุงููุธุงู - Updates

## ุงูุชุงุฑูุฎ: 2025-10-17

### โจ ุงูุชุญุณููุงุช ุงูุฑุฆูุณูุฉ

#### 1. ุฅุตูุงุญ ุฎุทุฃ `extract_take_profits()` ู `extract_stop_loss()`
**ุงููุดููุฉ:**
```
TypeError: SignalParser.extract_take_profits() missing 1 required positional argument: 'symbol'
```

**ุงูุญู:**
- ุชู ุชุญุฏูุซ ุงุณุชุฏุนุงุก ุงูุฏูุงู ูู [telegram_client.py:190-191](telegram_client.py#L190-L191)
- ุฅุถุงูุฉ ูุนุงูู `symbol` ุงููุทููุจ ูููุง ุงูุฏุงูุชูู
- ูุจู: `extract_take_profits(message_text)`
- ุจุนุฏ: `extract_take_profits(message_text, symbol if symbol else "")`

#### 2. ุชุญููู ุฑุณุงุฆู ุงูุฎุทุฃ ูู ุงููููุณูู ุฅูู ุงููุงุฌูุฉ ุงูุฑุณูููุฉ

**ุงูุชุญุณููุงุช:**

##### ุฃ. ูุธุงู Callback ูุญุณูู ูู `telegram_client.py`
- ุฅุถุงูุฉ `message_callback` ุฌุฏูุฏ ููุนุงูุฌุฉ ุฌููุน ุงูุฑุณุงุฆู
- ุฌูุน ูุนูููุงุช ุงูุชุดุฎูุต ุงูุชูุตูููุฉ ููุฑุณุงุฆู ุงููุงุดูุฉ
- ุฅุฑุณุงู ุงูุจูุงูุงุช ูููุงุฌูุฉ ุจุฏูุงู ูู ุทุจุงุนุชูุง ูู ุงููููุณูู

```python
# ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ:
self.message_callback = None  # callback ูุฌููุน ุงูุฑุณุงุฆู

def set_message_callback(self, callback: Callable):
    """ุชุนููู ุฏุงูุฉ callback ูุฌููุน ุงูุฑุณุงุฆู (ูุงุฌุญุฉ ุฃู ูุงุดูุฉ)"""
    self.message_callback = callback
```

##### ุจ. ูุงุฌูุฉ ุฑุณุงุฆู ูุญุณููุฉ ูู `main_gui.py`

**ุนุฑุถ ุงูุฑุณุงุฆู ุงููุงุฌุญุฉ:**
- ุจุทุงูุงุช ุฎุถุฑุงุก ูุน ุชูุงุตูู ุงูุฅุดุงุฑุฉ ูุงููุฉ
- ุงูุฑูุฒุ ููุน ุงูุตููุฉุ ุณุนุฑ ุงูุฏุฎูู
- ุฌููุน ูุณุชููุงุช TP ู SL ุจุดูู ููุธู

**ุนุฑุถ ุงูุฑุณุงุฆู ุงููุงุดูุฉ:**
- ุจุทุงูุงุช ุญูุฑุงุก ูุน ูุต ุงูุฑุณุงูุฉ ุงูุฃุตููุฉ
- ูุณู ุชุดุฎูุต ุชูุตููู ููุธูุฑ:
  - โ/โ ุงูุฑูุฒ: ุชู/ูู ูุชู ุงูุชุนุฑู ุนููู
  - โ/โ ููุน ุงูุตููุฉ: ุชู/ูู ูุชู ุงูุชุนุฑู ุนููู
  - โ/โ ุณุนุฑ ุงูุฏุฎูู: ุชู/ูู ูุชู ุงูุนุซูุฑ ุนููู
  - โ/โ ุฃูุฏุงู ุงูุฑุจุญ: ุชู/ูู ูุชู ุงูุนุซูุฑ ุนูููุง
  - โ/โ ููู ุงูุฎุณุงุฑุฉ: ุชู/ูู ูุชู ุงูุนุซูุฑ ุนููู

##### ุฌ. ุชูุธูู ุงูููุฏ ูู `signal_parser.py`
- ุฅุฒุงูุฉ ุฌููุน ุฑุณุงุฆู `print()` ุบูุฑ ุงูุถุฑูุฑูุฉ
- ุงูุงุญุชูุงุธ ููุท ุจู `traceback.print_exc()` ููุชุทููุฑ
- ุฌุนู ุงูููุฏ ุฃูุธู ูุฃุณูู ููุตูุงูุฉ

---

## ๐ ููุฎุต ุงูุชุบููุฑุงุช

### ุงููููุงุช ุงููุนุฏูุฉ:

1. **[telegram_client.py](telegram_client.py)**
   - ุฅุตูุงุญ ุงูุณุทุฑ 190-191: ุฅุถุงูุฉ ูุนุงูู `symbol`
   - ุฅุถุงูุฉ `message_callback` (ุงูุณุทุฑ 21)
   - ุฅุถุงูุฉ `set_message_callback()` (ุงูุณุทุฑ 80-82)
   - ุชุญุฏูุซ `message_handler()` ูุฌูุน ุจูุงูุงุช ุงูุชุดุฎูุต (ุงูุณุทุฑ 143-194)

2. **[main_gui.py](main_gui.py)**
   - ุฅุถุงูุฉ `on_message_received()` (ุงูุณุทุฑ 986-989)
   - ุชุญุฏูุซ `create_live_message_card()` ูุนุฑุถ ุงูุชุดุฎูุต (ุงูุณุทุฑ 810-852)
   - ุฑุจุท ุงูู callback ูู `do_connect()` (ุงูุณุทุฑ 583)

3. **[signal_parser.py](signal_parser.py)**
   - ุฅุฒุงูุฉ ุฑุณุงุฆู print ูู `parse()` (ุงูุณุทุฑ 315-342)
   - ุฅุฒุงูุฉ ุฑุณุงุฆู print ูู `validate_signal_data()` (ุงูุณุทุฑ 355-383)

---

## ๐ฏ ุงูููุงุฆุฏ

### ูููุณุชุฎุฏู:
- โ **ูุงุฌูุฉ ุงุญุชุฑุงููุฉ**: ุฌููุน ุงูุฑุณุงุฆู ุชุธูุฑ ูู ูุงูุฐุฉ ูุงุญุฏุฉ ููุธูุฉ
- โ **ุชุดุฎูุต ูุงุถุญ**: ูุนุฑูุฉ ุจุงูุถุจุท ููุงุฐุง ูุดูุช ุงูุฑุณุงูุฉ
- โ **ูุง ูุฒูุฏ ูู ุงููููุณูู**: ูู ุดูุก ูู ุงููุงุฌูุฉ ุงูุฑุณูููุฉ

### ูููุทูุฑ:
- โ **ููุฏ ูุธูู**: ุฅุฒุงูุฉ print statements ุบูุฑ ููุธูุฉ
- โ **ูุนูุงุฑูุฉ ุฃูุถู**: ุงุณุชุฎุฏุงู callbacks ุจุฏูุงู ูู print
- โ **ุณูููุฉ ุงูุตูุงูุฉ**: ูุตู ุงูููุทู ุนู ุงูุนุฑุถ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ:

1. **ุงุฎุชุจุงุฑ ุฑุณุงูุฉ ูุงุฌุญุฉ:**
   ```
   XAUUSD BUY 4338
   TP 4340
   TP 4345
   SL 4326
   ```
   - ูุฌุจ ุฃู ุชุธูุฑ ุจุทุงูุฉ ุฎุถุฑุงุก ูุน ูู ุงูุชูุงุตูู

2. **ุงุฎุชุจุงุฑ ุฑุณุงูุฉ ูุงุดูุฉ (ุจุฏูู TP):**
   ```
   Gold buy Now
   ```
   - ูุฌุจ ุฃู ุชุธูุฑ ุจุทุงูุฉ ุญูุฑุงุก
   - ูุณู ุงูุชุดุฎูุต ูุธูุฑ: โ ุงูุฑูุฒ, โ ููุน ุงูุตููุฉ, โ ุฃูุฏุงู ุงูุฑุจุญ

3. **ุงุฎุชุจุงุฑ ุฑุณุงูุฉ ูุงุดูุฉ (ุฑุณุงูุฉ ุนุดูุงุฆูุฉ):**
   ```
   Hi, welcome to the channel!
   ```
   - ุจุทุงูุฉ ุญูุฑุงุก
   - ุงูุชุดุฎูุต ูุธูุฑ: โ ูุฌููุน ุงูุนูุงุตุฑ

---

## ๐ ููุงุฑูุฉ ูุจู/ุจุนุฏ

### ูุจู ุงูุชุญุฏูุซ:
```
โ ุฎุทุฃ ูู ูุนุงูุฌุฉ ุงูุฑุณุงูุฉ: SignalParser.extract_take_profits() missing 1 required positional argument: 'symbol'
Traceback (most recent call last):
  File "telegram_client.py", line 190, in message_handler
    take_profits = self.signal_parser.extract_take_profits(message_text)
TypeError: SignalParser.extract_take_profits() missing 1 required positional argument: 'symbol'
```

### ุจุนุฏ ุงูุชุญุฏูุซ:
- โ ูุง ุฃุฎุทุงุก
- โ ุฑุณุงุฆู ูุงุถุญุฉ ูู ุงููุงุฌูุฉ
- โ ุชุดุฎูุต ุชูุตููู

---

## ๐ ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ ุงููุญุชููุฉ

1. **ููุชุฑุฉ ุงูุฑุณุงุฆู:**
   - ุฅุถุงูุฉ ุฎูุงุฑ ูุฅุฎูุงุก ุงูุฑุณุงุฆู ุงููุงุดูุฉ
   - ููุชุฑุฉ ุญุณุจ ุงูููุงุฉ ุฃู ููุน ุงูุฎุทุฃ

2. **ุฅุญุตุงุฆูุงุช:**
   - ุนุฑุถ ูุณุจุฉ ูุฌุงุญ ูู ููุงุฉ
   - ุฃูุซุฑ ุงูุฃุฎุทุงุก ุดููุนุงู

3. **ุชุนูู ุฐูู:**
   - ุงูุชุฑุงุญุงุช ูุชุญุณูู ุฃููุงุท ุงูุฑุณุงุฆู ุบูุฑ ุงููุฏุนููุฉ

---

## ๐ ููุงุญุธุงุช ูููุทูุฑูู

### ุงุณุชุฎุฏุงู ุงูู Callbacks:

```python
# ูู telegram_client
self.telegram_client.set_message_callback(self.on_message_received)

# ูู main_gui
async def on_message_received(self, message_data: dict, signal: Signal = None):
    """ูุนุงูุฌุฉ ุฌููุน ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ"""
    self.root.after(0, lambda: self.add_live_message_to_ui(message_data, signal))
```

### ุจููุฉ message_data:

```python
message_data = {
    'channel_name': str,
    'channel_id': int,
    'message_text': str,
    'time': str,
    'parsed': bool,
    'signal_info': {...},  # ุฅุฐุง ูุงูุช ูุงุฌุญุฉ
    'diagnostics': {...}   # ุฅุฐุง ูุงูุช ูุงุดูุฉ
}
```

---

## โ ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ุฌููุน ุงููุดุงูู ุงููุทููุจุฉ:
1. โ ุฅุตูุงุญ ุฎุทุฃ `extract_take_profits()`
2. โ ุชุญููู ุฑุณุงุฆู ุงูุฎุทุฃ ูู ุงููููุณูู ุฅูู ุงููุงุฌูุฉ
3. โ ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุจุดูู ูุจูุฑ
4. โ ููุฏ ุฃูุธู ูุฃุณูู ููุตูุงูุฉ

ุงููุธุงู ุงูุขู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุจูุงุฌูุฉ ุงุญุชุฑุงููุฉ ูุงููุฉ!
